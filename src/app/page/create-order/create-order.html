<div class="pos-container">
  
  <div class="left-panel">
    <div class="bill-header">
      <h1>SALE PRO</h1>
      <div class="time-info">{{ currentTime | date:'HH:mm:ss dd/MM/yyyy' }}</div>
      <div class="customer-info">
        Kh√°ch: 
        <ng-container *ngFor="let c of customers">
            <strong *ngIf="c.id == selectedCustomerId">{{ c.name }}</strong>
        </ng-container>
        <span *ngIf="!selectedCustomerId">--- Ch·ªçn kh√°ch ---</span>
      </div>
    </div>

    <div class="cart-scroll-area">
      <div class="cart-item" *ngFor="let item of cart; let i = index">
        <div class="item-info-col">
          <div class="item-name">{{ item.product.name }}</div>
          <div class="item-price-single">{{ item.price | number }} ƒë</div>
        </div>
        
        <div class="item-qty-col">
          <button class="btn-qty" (click)="updateQuantity(item, -1)">-</button>
          <span class="qty-val">{{ item.quantity }}</span>
          <button class="btn-qty" (click)="updateQuantity(item, 1)">+</button>
        </div>

        <div class="item-total-col">
          {{ item.quantity * item.price | number }}
        </div>
        
        <button class="btn-remove" (click)="removeFromCart(i)">√ó</button>
      </div>

      <div *ngIf="cart.length === 0" class="empty-cart">
        <p>Gi·ªè h√†ng tr·ªëng</p>
      </div>
    </div>

    <div class="bill-footer">
      <div class="total-row" style="font-size: 16px; margin-bottom: 5px;">
        <span>S·ªë l∆∞·ª£ng SP:</span>
        <strong>{{ totalItems }}</strong>
      </div>
      <div class="total-row">
        <span>T·ªîNG C·ªòNG:</span>
        <span class="total-price">{{ totalAmount | number }} ƒë</span>
      </div>
      
      <div class="action-buttons">
        <button class="btn-print" (click)="printInvoice()" [disabled]="cart.length === 0">
          IN H√ìA ƒê∆†N
        </button>
        <button class="btn-pay" (click)="submitOrder()" [disabled]="cart.length === 0">
          THANH TO√ÅN
        </button>
        <button class="btn-cancel" (click)="cancel()">H·ª¶Y</button>
      </div>
    </div>
  </div>

  <div class="right-panel">
    <div class="filters-section">
      <div class="filter-group">
        <label>Kh√°ch h√†ng</label>
        <select [(ngModel)]="selectedCustomerId" class="form-control">
          <option *ngFor="let c of customers" [value]="c.id">{{ c.name }}</option>
        </select>
      </div>
      <div class="filter-group">
        <label>Thanh to√°n</label>
        <select [(ngModel)]="selectedPaymentMethod" class="form-control">
          <option value="cash">Ti·ªÅn m·∫∑t</option>
          <option value="transfer">Chuy·ªÉn kho·∫£n</option>
        </select>
      </div>
    </div>

    <div class="search-bar-wrapper">
      <input type="text" placeholder="T√¨m s·∫£n ph·∫©m..." [(ngModel)]="searchKeyword" (keyup)="onSearch()">
      <span class="search-icon">üîç</span>
    </div>

    <div class="product-list-wrapper">
      <div class="table-header">
        <span class="th-name">S·∫£n ph·∫©m</span>
        <span class="th-cat">Danh m·ª•c</span>
        <span class="th-stock">T·ªìn</span>
        <span class="th-price">Gi√°</span>
        <span class="th-add"></span>
      </div>
      
      <div class="product-scroll-area">
        <div class="product-row" 
             *ngFor="let p of filteredProducts" 
             (click)="addToCart(p)"
             [ngClass]="{'row-disabled': p.stockQuantity <= 0}">
          
          <div class="td-name">
            {{ p.name }}
            <span *ngIf="p.stockQuantity <= 0" class="badge-out">H·∫øt</span>
          </div>
          <div class="td-cat">{{ p.category?.name }}</div>
          
          <div class="td-stock" [style.color]="p.stockQuantity < 5 ? 'red' : 'green'">
            <strong>{{ p.stockQuantity }}</strong>
          </div>
          
          <div class="td-price">{{ p.price | number }}</div>
          
          <div class="td-add">
            <button class="btn-add-mini" [disabled]="p.stockQuantity <= 0">+</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="invoice-template" *ngIf="invoiceData">
  
    <div class="inv-header">
      <h2>SALE PRO STORE</h2>
      <p>ƒêC: 123 ƒê∆∞·ªùng ABC, Qu·∫≠n 1, TP.HCM</p>
      <p>Hotline: 0909.123.456</p>
      
      <div class="inv-title">H√ìA ƒê∆†N THANH TO√ÅN</div>
    </div>
  
    <div class="inv-info">
      <div><strong>M√£ ƒë∆°n:</strong> #{{ invoiceData.orderId }}</div>
      <div><strong>Ng√†y:</strong> {{ invoiceData.date | date:'dd/MM/yyyy HH:mm' }}</div>
      <div><strong>Kh√°ch h√†ng:</strong> {{ invoiceData.customerName }}</div>
      <div><strong>Thu ng√¢n:</strong> Admin User</div>
    </div>
  
    <table class="inv-table">
      <thead>
        <tr>
          <th>T√™n s·∫£n ph·∫©m</th>
          <th class="col-sl">SL</th>
          <th class="col-gia">ƒê∆°n gi√°</th>
          <th class="col-gia">Th√†nh ti·ªÅn</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of invoiceData.items">
          <td>{{ item.product.name }}</td>
          <td class="col-sl">{{ item.quantity }}</td>
          <td class="col-gia">{{ item.price | number:'1.0-0' }}</td>
          <td class="col-gia">{{ item.quantity * item.price | number:'1.0-0' }}</td>
        </tr>
      </tbody>
    </table>
  
    <div class="inv-total">
      <div class="row">
        <span>T·ªïng ti·ªÅn h√†ng:</span>
        <span>{{ invoiceData.totalAmount | number:'1.0-0' }}</span>
      </div>
      <div class="row">
        <span>Chi·∫øt kh·∫•u:</span>
        <span>0</span>
      </div>
      <div class="row final">
        <span>T·ªîNG C·ªòNG:</span>
        <span>{{ invoiceData.totalAmount | number:'1.0-0' }} ƒë</span>
      </div>
      <div class="row" style="font-size: 14px; margin-top: 5px;">
        <span>H√¨nh th·ª©c:</span>
        <span>{{ invoiceData.paymentMethod }}</span>
      </div>
    </div>
  
    <div class="inv-footer">
      <p>C·∫£m ∆°n qu√Ω kh√°ch ƒë√£ mua h√†ng!</p>
      <p>H·∫πn g·∫∑p l·∫°i qu√Ω kh√°ch.</p>
    </div>
  
</div>